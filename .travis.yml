language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: UBKhypMx/ZKABnUrRePG/XBKOG7399KznQnpdWtiQSI1Yu061scy/4YN9eDnEDIXhKPCWbJlaWjxC+K3drJUImuSVjfVs5oB4rfH18HXeOLJsVJhV7g9Nk0lPm2RW4DYyEX2w9O6hNaMYLQpcOZFzS1yDPb/FZKrobat+BW1p2wZyeYTZVNTjtsEi/gPjO4JgN3VgGgm9MFuS14S9EQKXypKRZ/bRJe2wa+/NbFXTBaAUoauuSl1EppUQWSMkDhLV9NKFpv3N/yLKv+kkB0fAWqyftL9xnbjgWUAJGe/kbWrCFuuf/vh3zS4OiMw3xQ7fM6LP0DyZUEi72i+z57pmr2xBP3NmcI82WwNdm6dCrwy8iBGpLNY2hbA/Tw5wZLtaFTqWi6K0nkGVfjn983JKaEH/h1TGtTZvsircpnO+oi4CSDBLdSuJjt6GBfRySIeNZyEPpGE6L/u4VTK5gYc6qnLBP46Smqlw/eAZSQK8fQEgmamp8QtSR1V2SYSF3VPa7dA77iuNGdVqhKOqE85Cc+x5E0XmUKTCt5ZOqZf5kixpEa0v/dp7/M4dDD8BWumRYJJYuFxPR0HG2W5F5jYz8Cb6EVRlwZuSROlpzXESgS+vduqw6V7iB9KbGLSkF27fGtHDZUDQd1bdBnxAVfTjNt+/JntnvZ6wX1//EYK4DI=
  file:
    - "spt-development-audit-spring-boot-autoconfigure/target/spt-development-audit-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-audit-spring-boot-starter/target/spt-development-audit-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
